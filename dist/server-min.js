"use strict";var __awaiter=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))(function(a,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,r)}c((n=n.apply(e,t||[])).next())})},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const express_1=__importDefault(require("express")),fs_1=__importDefault(require("fs")),Backend_1=require("./Backend"),HomePage_1=require("./HomePage"),Port=process.env.Port||3e3,app=express_1.default();app.use("/style.css",express_1.default.static("./dist/css")),app.use(express_1.default.json());const server=app.listen(Port,()=>{console.log(`server ist starting on port ${Port}`)});app.get("/",(e,t)=>{t.sendFile(`${__dirname}/index.html`)}),app.get("/backend",(e,t)=>{t.sendFile(`${__dirname}/backend.html`)}),app.get("/js/app.js",(e,t)=>{t.sendFile(`${__dirname}/js/app.js`)}),app.get("/css/style.css",(e,t)=>{t.sendFile(`${__dirname}/css/style.css`)}),app.get(/assets\/fonts\/.*/i,(e,t)=>{fs_1.default.existsSync(__dirname+e.path)?t.sendFile(__dirname+e.path):t.sendStatus(404)}),app.get("/favicon.ico",(e,t)=>{t.sendFile(`${__dirname}/assets/favicon.ico`)}),app.get("/test",(e,t)=>__awaiter(void 0,void 0,void 0,function*(){const e=new HomePage_1.HomePage;yield e.buildPage(),t.send(e.getHtmlString())})),app.get("/titlename",(e,t)=>__awaiter(void 0,void 0,void 0,function*(){const e=new Backend_1.Backend,s=JSON.parse(fs_1.default.readFileSync("sqlCommands.json").toString());try{const n=yield e.executeSQL(s.titleName);t.json({titleName:n[0].Text_Content})}catch(e){t.json({err:!0,msg:e})}})),app.post("/titlename",(e,t)=>__awaiter(void 0,void 0,void 0,function*(){const s=new Backend_1.Backend;try{yield s.executeSQL("UPDATE `content` SET `Text_Content` = '"+e.body.titleName+"'")}catch(e){t.json({err:!0,msg:e})}t.sendStatus(200)}));